# ä¾¦å¯Ÿ-ç«åŠ›æ‰“å‡»ä»¿çœŸç¤ºä¾‹æ¨¡å‹æ‹†è§£åˆ†ææŠ¥å‘Š

## ç›®å½•
- [1. ä»¿çœŸæ„ä»¶æ¸…å•](#1-ä»¿çœŸæ„ä»¶æ¸…å•)
  - [1.1 å®ä½“åˆ†æ](#11-å®ä½“åˆ†æ)
  - [1.2 åŠ¨ä½œåˆ†æ](#12-åŠ¨ä½œåˆ†æ)
  - [1.3 æ´»åŠ¨åˆ†æ](#13-æ´»åŠ¨åˆ†æ)
  - [1.4 äº¤äº’åˆ†æ](#14-äº¤äº’åˆ†æ)
  - [1.5 èµ„æºåˆ†æ](#15-èµ„æºåˆ†æ)
  - [1.6 å…¨å±€å˜é‡åˆ†æ](#16-å…¨å±€å˜é‡åˆ†æ)
- [2. EATIè¦ç´ æ˜ å°„](#2-eatiè¦ç´ æ˜ å°„)
- [3. åŠŸèƒ½è¦†ç›–çŸ©é˜µ](#3-åŠŸèƒ½è¦†ç›–çŸ©é˜µ)
- [4. SimPyé¢„æœŸè¡Œä¸ºè§„èŒƒ](#4-simpyé¢„æœŸè¡Œä¸ºè§„èŒƒ)
- [5. é»„é‡‘æœŸæœ›ï¼ˆGolden Expectationsï¼‰](#5-é»„é‡‘æœŸæœ›golden-expectations)
- [æ€»ç»“](#æ€»ç»“)

---

## 1. ä»¿çœŸæ„ä»¶æ¸…å•

### 1.1 å®ä½“åˆ†æ

#### 1.1.1 å®ä½“ç±»æ¶æ„

**åŸºç¡€æ¶æ„**
```python
BaseEntity (åŸºç¡€å®ä½“ç±»)
â”œâ”€â”€ é€šç”¨å±æ€§ï¼šid, env, simulation, current_action, current_activity
â”œâ”€â”€ æ¶ˆæ¯ç³»ç»Ÿï¼šmessage_queue (SimPy Store)
â”œâ”€â”€ çŠ¶æ€ç®¡ç†ï¼šupdate_status(), get_context()
â””â”€â”€ æ´»åŠ¨åç§°è¿½è¸ªï¼šcurrent_activity_name, current_activity_chinese_name
```

#### 1.1.2 å…·ä½“å®ä½“åˆ†æ

##### CommandPostï¼ˆæŒ‡æŒ¥æ‰€ï¼‰
- **å®ä½“ç±»å‹**: `passive`ï¼ˆè¢«åŠ¨å®ä½“ï¼‰
- **æ ¸å¿ƒå±æ€§**:
  ```python
  {
    "name": "æŒ‡æŒ¥æ‰€",
    "call_sign": "Eagle",
    "unit_type": "command",
    "alert_level": 1,
    "position": {"x": 0.0, "y": 0.0, "z": 0.0}
  }
  ```
- **è¡Œä¸ºèƒ½åŠ›**:
  - æ¥æ”¶å’Œå¤„ç†æ•Œæƒ…æŠ¥å‘Š
  - å¨èƒåˆ†æå’Œå†³ç­–åˆ¶å®š
  - ä¸‹è¾¾ç«åŠ›å‘½ä»¤å’Œåœç«å‘½ä»¤
- **æ¶ˆæ¯å¤„ç†**: 
  - `enemy_report` â†’ è§¦å‘æƒ…æŠ¥å¤„ç†
  - `bda_report` â†’ æ¥æ”¶æ¯ä¼¤è¯„ä¼°

##### ArtilleryBattalionï¼ˆç‚®å…µè¥ï¼‰
- **å®ä½“ç±»å‹**: `agent`ï¼ˆä¸»åŠ¨å®ä½“ï¼‰
- **æ ¸å¿ƒå±æ€§**:
  ```python
  {
    "name": "ç‚®å…µè¥",
    "call_sign": "Thunder", 
    "unit_type": "artillery",
    "guns_count": "18",
    "fire_status": "ready|preparing|firing|ceased",
    "rounds_fired": 0
  }
  ```
- **è¡Œä¸ºèƒ½åŠ›**:
  - ç«ç‚®å‡†å¤‡å’Œæ ¡å‡†
  - ç«åŠ›é½å°„æ‰§è¡Œ
  - å¼¹è¯æ¶ˆè€—ç®¡ç†
  - çŠ¶æ€æŠ¥å‘Š
- **æ¶ˆæ¯å¤„ç†**:
  - `fire_order` â†’ è§¦å‘ç«åŠ›ä»»åŠ¡
  - `cease_fire` â†’ åœæ­¢å°„å‡»

##### ReconSquadï¼ˆæ­¥å…µä¾¦å¯Ÿç­ï¼‰
- **å®ä½“ç±»å‹**: `agent`ï¼ˆä¸»åŠ¨å®ä½“ï¼‰
- **æ ¸å¿ƒå±æ€§**:
  ```python
  {
    "name": "æ­¥å…µä¾¦å¯Ÿç­",
    "call_sign": "Scout",
    "unit_type": "recon", 
    "squad_size": "8",
    "patrol_status": "patrolling",
    "enemy_contact": false
  }
  ```
- **è¡Œä¸ºèƒ½åŠ›**:
  - å·¡é€»ç§»åŠ¨å’ŒåŒºåŸŸæ‰«æ
  - æ•Œæƒ…å‘ç°å’Œæƒ…æŠ¥æ”¶é›†
  - æ¯ä¼¤æ•ˆæœè§‚å¯Ÿè¯„ä¼°
- **è§¦å‘ç›‘æ§**:
  - è‡ªåŠ¨å·¡é€»å¾ªç¯
  - æ•Œæƒ…å‘ç°å“åº”
  - æ‰“å‡»å®Œæˆåæ¯ä¼¤è¯„ä¼°

#### 1.1.3 å®ä½“å…³ç³»å›¾

```mermaid
graph TD
    A[æ­¥å…µä¾¦å¯Ÿç­<br/>ReconSquad] -->|æ•Œæƒ…æŠ¥å‘Š| B[æŒ‡æŒ¥æ‰€<br/>CommandPost]
    B -->|ç«åŠ›å‘½ä»¤| C[ç‚®å…µè¥<br/>ArtilleryBattalion]
    A -->|æ¯ä¼¤è¯„ä¼°| B
    B -->|åœç«å‘½ä»¤| C
    
    A -.->|å·¡é€»ç›‘æ§| A
    C -.->|èµ„æºæ¶ˆè€—| D[å¼¹è¯å‚¨å¤‡<br/>res_artillery_rounds]
```

### 1.2 åŠ¨ä½œåˆ†æ

#### 1.2.1 åŠ¨ä½œç±»å±‚æ¬¡ç»“æ„

```python
ActionBase (åŠ¨ä½œåŸºç±»)
â”œâ”€â”€ execute() - é€šç”¨æ‰§è¡Œæ¡†æ¶
â”œâ”€â”€ do_execute() - å…·ä½“æ‰§è¡Œé€»è¾‘ (å­ç±»å®ç°)
â””â”€â”€ é”™è¯¯å¤„ç†å’Œä¸­æ–­æ”¯æŒ
```

#### 1.2.2 åŠ¨ä½œç±»è¯¦ç»†åˆ†æ

| åŠ¨ä½œç±» | æ‰€å±å®ä½“ | è§¦å‘æ¡ä»¶ | æ‰§è¡Œæµç¨‹ | èµ„æºéœ€æ±‚ | é¢„æœŸç»“æœ |
|--------|----------|----------|----------|----------|----------|
| **ActionPatrol** | ReconSquad | å®ä½“å¯åŠ¨æ—¶ | å¾ªç¯ï¼šç§»åŠ¨å·¡é€»â†’åŒºåŸŸæ‰«æ | æ—  | æŒç»­å·¡é€»ç›´åˆ°å‘ç°æ•Œæƒ… |
| **ActionReportEnemy** | ReconSquad | enemy_contact=true | æ”¶é›†æƒ…æŠ¥â†’å‘é€æŠ¥å‘Š | æ—  | æ•Œæƒ…ä¿¡æ¯ä¼ é€’ç»™æŒ‡æŒ¥æ‰€ |
| **ActionAssessDamage** | ReconSquad | StrikeCompleted=true | è§‚å¯Ÿæ‰“å‡»â†’æŠ¥å‘Šæ¯ä¼¤ | æ—  | æ¯ä¼¤è¯„ä¼°æ•°æ® |
| **ActionProcessIntel** | CommandPost | æ”¶åˆ°enemy_report | åˆ†ææŠ¥å‘Šâ†’å†³ç­–åˆ¶å®š | æ—  | ç«åŠ›å†³ç­–ï¼ˆå¼€ç«/ç»§ç»­è§‚å¯Ÿï¼‰ |
| **ActionIssueFireOrder** | CommandPost | å†³ç­–å¼€ç« | å‡†å¤‡å‘½ä»¤â†’ä¼ é€å‘½ä»¤ | æ—  | ç«åŠ›å‘½ä»¤å‘é€ç»™ç‚®å…µè¥ |
| **ActionCeaseFireOrder** | CommandPost | ä»»åŠ¡è¯„ä¼°å®Œæˆ | è¯„ä¼°ç»“æœâ†’å‘é€åœç«ä»¤ | æ—  | åœç«å‘½ä»¤ä¼ é€’ |
| **ActionExecuteFireMission** | ArtilleryBattalion | æ”¶åˆ°fire_order | å‡†å¤‡ç«ç‚®â†’æ‰§è¡Œé½å°„ | 36å‘ç‚®å¼¹ | ç«åŠ›æ‰“å‡»å®Œæˆ |
| **ActionCeaseFire** | ArtilleryBattalion | æ”¶åˆ°cease_fire | åœæ­¢å°„å‡»â†’çŠ¶æ€æŠ¥å‘Š | æ—  | æ¢å¤å°±ç»ªçŠ¶æ€ |

#### 1.2.3 åŠ¨ä½œæ‰§è¡Œæ¡ä»¶åˆ†æ

**å‰ç½®æ¡ä»¶æ£€æŸ¥**:
- `ActionExecuteFireMission`: æ£€æŸ¥å¼¹è¯å……è¶³æ€§ï¼ˆâ‰¥36å‘ï¼‰
- `ActionPatrol`: æ£€æŸ¥patrol_statuså’Œenemy_contactçŠ¶æ€
- `ActionAssessDamage`: æ£€æŸ¥å…¨å±€å˜é‡StrikeCompleted

**ç»ˆæ­¢æ¡ä»¶**:
- `ActionPatrol`: enemy_contactå˜ä¸ºtrueæ—¶ç»ˆæ­¢å¾ªç¯
- æ‰€æœ‰åŠ¨ä½œæ”¯æŒSimPyä¸­æ–­æœºåˆ¶

### 1.3 æ´»åŠ¨åˆ†æ

#### 1.3.1 æ´»åŠ¨åˆ†ç±»ä½“ç³»

```
æ´»åŠ¨ç±»å‹åˆ†ç±»:
â”œâ”€â”€ ç§»åŠ¨ç±»æ´»åŠ¨
â”‚   â””â”€â”€ activity_move_patrol (å·¡é€»ç§»åŠ¨)
â”œâ”€â”€ æ„ŸçŸ¥ç±»æ´»åŠ¨  
â”‚   â”œâ”€â”€ activity_scan_area (åŒºåŸŸæ‰«æ)
â”‚   â””â”€â”€ activity_observe_impact (è§‚å¯Ÿæ‰“å‡»æ•ˆæœ)
â”œâ”€â”€ ä¿¡æ¯å¤„ç†ç±»æ´»åŠ¨
â”‚   â”œâ”€â”€ activity_gather_intel (æ”¶é›†æƒ…æŠ¥)
â”‚   â”œâ”€â”€ activity_analyze_report (åˆ†ææŠ¥å‘Š)
â”‚   â””â”€â”€ activity_evaluate_results (è¯„ä¼°ç»“æœ)
â”œâ”€â”€ å†³ç­–ç±»æ´»åŠ¨
â”‚   â””â”€â”€ activity_make_decision (åšå‡ºå†³ç­–)
â”œâ”€â”€ é€šä¿¡ç±»æ´»åŠ¨
â”‚   â”œâ”€â”€ activity_send_enemy_report (å‘é€æ•Œæƒ…æŠ¥å‘Š)
â”‚   â”œâ”€â”€ activity_transmit_order (ä¼ é€å‘½ä»¤)
â”‚   â””â”€â”€ activity_report_bda (æŠ¥å‘Šæ¯ä¼¤è¯„ä¼°)
â”œâ”€â”€ å‡†å¤‡ç±»æ´»åŠ¨
â”‚   â”œâ”€â”€ activity_prepare_fire_order (å‡†å¤‡ç«åŠ›å‘½ä»¤)
â”‚   â””â”€â”€ activity_prepare_guns (å‡†å¤‡ç«ç‚®)
â””â”€â”€ æ‰§è¡Œç±»æ´»åŠ¨
    â”œâ”€â”€ activity_fire_barrage (ç«åŠ›é½å°„)
    â”œâ”€â”€ activity_stop_firing (åœæ­¢å°„å‡»)
    â””â”€â”€ activity_report_status (æŠ¥å‘ŠçŠ¶æ€)
```

#### 1.3.2 æ´»åŠ¨è¯¦ç»†è§„æ ¼

##### æ„ŸçŸ¥ä¸ç§»åŠ¨æ´»åŠ¨

| æ´»åŠ¨åç§° | è¾“å…¥å‚æ•° | æ‰§è¡Œæ—¶é—´ | è¾“å‡ºç»“æœ | ç®—æ³•æè¿° |
|----------|----------|----------|----------|----------|
| **activity_move_patrol** | å½“å‰ä½ç½®ã€æ—¶é—´ | 30ç§’ï¼ˆå›ºå®šï¼‰ | æ–°ä½ç½®åæ ‡ | åœ†å½¢è·¯å¾„ï¼šradius=200, center=(100,100) |
| **activity_scan_area** | æ—  | 10ç§’ï¼ˆå›ºå®šï¼‰ | å¸ƒå°”å€¼ï¼ˆæ•Œæƒ…å‘ç°ï¼‰ | 30%éšæœºæ¦‚ç‡å‘ç°æ•Œæƒ… |
| **activity_observe_impact** | æ—  | 60ç§’ï¼ˆå›ºå®šï¼‰ | æ¯ä¼¤ç¨‹åº¦[0.7,1.0] | éšæœºç”Ÿæˆæ¯ä¼¤è¯„ä¼°å€¼ |

##### ä¿¡æ¯å¤„ç†æ´»åŠ¨

| æ´»åŠ¨åç§° | è¾“å…¥å‚æ•° | æ‰§è¡Œæ—¶é—´ | è¾“å‡ºç»“æœ | ç®—æ³•æè¿° |
|----------|----------|----------|----------|----------|
| **activity_gather_intel** | æ•Œæƒ…å‘ç°çŠ¶æ€ | 20-40ç§’ï¼ˆå‡åŒ€åˆ†å¸ƒï¼‰ | æ•Œå†›è¯¦ç»†ä¿¡æ¯ | ç”Ÿæˆç»“æ„åŒ–æ•Œæƒ…æ•°æ® |
| **activity_analyze_report** | æ•Œæƒ…ä¿¡æ¯ | 30ç§’ï¼ˆå›ºå®šï¼‰ | å¨èƒç­‰çº§[0,1] | å¨èƒè¯„ä¼°ç®—æ³• |
| **activity_make_decision** | å¨èƒç­‰çº§ | 20ç§’ï¼ˆå›ºå®šï¼‰ | å¼€ç«å†³ç­– | å¨èƒ>0.6åˆ™å†³å®šå¼€ç« |
| **activity_evaluate_results** | æ¯ä¼¤è¯„ä¼° | 20ç§’ï¼ˆå›ºå®šï¼‰ | ä»»åŠ¡æˆåŠŸåˆ¤æ–­ | æ¯ä¼¤â‰¥0.8ä¸ºæˆåŠŸ |

##### ç«åŠ›ç›¸å…³æ´»åŠ¨

| æ´»åŠ¨åç§° | è¾“å…¥å‚æ•° | æ‰§è¡Œæ—¶é—´ | èµ„æºæ¶ˆè€— | çŠ¶æ€å˜åŒ– |
|----------|----------|----------|----------|----------|
| **activity_prepare_guns** | æ—  | 60ç§’ï¼ˆåˆ†6é˜¶æ®µï¼‰ | æ—  | fire_statusâ†’'preparing' |
| **activity_fire_barrage** | æ—  | 120ç§’ï¼ˆåˆ†4é˜¶æ®µï¼‰ | 36å‘ç‚®å¼¹ | fire_statusâ†’'firing'ï¼Œrounds_fired+36 |
| **activity_stop_firing** | æ—  | 10ç§’ï¼ˆå›ºå®šï¼‰ | æ—  | fire_statusâ†’'ceased' |

#### 1.3.3 æ´»åŠ¨æ‰§è¡Œæµç¨‹å›¾

```mermaid
graph TB
    subgraph "ä¾¦å¯Ÿå¾ªç¯"
        A[activity_move_patrol] --> B[activity_scan_area]
        B -->|æœªå‘ç°æ•Œæƒ…| A
        B -->|å‘ç°æ•Œæƒ…| C[activity_gather_intel]
    end
    
    subgraph "æƒ…æŠ¥å¤„ç†"
        C --> D[activity_send_enemy_report]
        D --> E[activity_analyze_report]
        E --> F[activity_make_decision]
    end
    
    subgraph "ç«åŠ›æ‰“å‡»"
        F -->|å†³å®šå¼€ç«| G[activity_prepare_fire_order]
        G --> H[activity_transmit_order]
        H --> I[activity_prepare_guns]
        I --> J[activity_fire_barrage]
    end
    
    subgraph "æ¯ä¼¤è¯„ä¼°"
        J --> K[activity_observe_impact]
        K --> L[activity_report_bda]
        L --> M[activity_evaluate_results]
        M --> N[activity_stop_firing]
    end
```

#### 1.3.4 æ´»åŠ¨è£…é¥°å™¨ç³»ç»Ÿ

æ‰€æœ‰æ´»åŠ¨å‡½æ•°éƒ½ä½¿ç”¨`@enhanced_activity_wrapper`è£…é¥°å™¨ï¼š

**åŠŸèƒ½ç‰¹æ€§**:
- è‡ªåŠ¨è®°å½•æ´»åŠ¨å¼€å§‹/ç»“æŸæ—¶é—´
- ç”Ÿæˆæ´»åŠ¨ä¸­æ–‡åç§°ï¼ˆä»docstringæå–ï¼‰
- å‘é€WebSocketæ¶ˆæ¯ï¼ˆACTIVITY_STARTED/COMPLETEDï¼‰
- è®°å½•åˆ°ActivityTimelineLogger
- æ”¯æŒå•æ­¥è°ƒè¯•çš„æš‚åœæ£€æŸ¥
- å¼‚å¸¸å¤„ç†å’Œé”™è¯¯è®°å½•

**æ¶ˆæ¯æ ¼å¼**:
```python
{
    "type": "ACTIVITY_STARTED|ACTIVITY_COMPLETED",
    "entity_id": "ent_recon_squad",
    "data": {
        "activity": "activity_move_patrol",           # å®Œæ•´å‡½æ•°å
        "activity_name": "move_patrol",              # ç®€åŒ–åç§°  
        "activity_chinese_name": "å·¡é€»ç§»åŠ¨",         # ä¸­æ–‡åç§°
        "entity_name": "æ­¥å…µä¾¦å¯Ÿç­",
        "start_time": 0.0,
        "end_time": 30.0,
        "duration": 30.0
    }
}
```

### 1.4 äº¤äº’åˆ†æ

#### 1.4.1 æ¶ˆæ¯ä¼ é€’æ¶æ„

```mermaid
graph TD
    subgraph "æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿ"
        A[ReconSquad.message_queue] 
        B[CommandPost.message_queue]
        C[ArtilleryBattalion.message_queue]
    end
    
    subgraph "WebSocketé€šä¿¡"
        D[WebSocketManager]
        E[å¤šå®¢æˆ·ç«¯è¿æ¥]
        F[å®æ—¶æ—¥å¿—æ¨é€]
    end
    
    subgraph "æ¶ˆæ¯æ”¶é›†"
        G[MessageCollector]
        H[æŒ‰ç±»å‹åˆ†ç»„]
        I[å¢é‡æ¨é€]
    end
    
    A -->|enemy_report| B
    B -->|fire_order| C  
    B -->|cease_fire| C
    A -->|bda_report| B
    
    G --> D
    D --> E
    D --> F
```

#### 1.4.2 æ¶ˆæ¯ç±»å‹è§„èŒƒ

| æ¶ˆæ¯ç±»å‹ | æºå®ä½“ | ç›®æ ‡å®ä½“ | æ•°æ®ç»“æ„ | è§¦å‘æ¡ä»¶ |
|----------|--------|----------|----------|----------|
| **enemy_report** | ReconSquad | CommandPost | `{type, source, enemy_position, enemy_strength, report_time, enemy_info}` | æƒ…æŠ¥æ”¶é›†å®Œæˆ |
| **fire_order** | CommandPost | ArtilleryBattalion | `{type, source, target_position, fire_type, rounds_count, fire_order}` | å†³ç­–å¼€ç« |
| **cease_fire** | CommandPost | ArtilleryBattalion | `{type, source}` | ä»»åŠ¡è¯„ä¼°å®Œæˆ |
| **bda_report** | ReconSquad | CommandPost | `{type, source, damage_assessment, target_status}` | æ¯ä¼¤è¯„ä¼°å®Œæˆ |

#### 1.4.3 WebSocketå®æ—¶é€šä¿¡

**æœåŠ¡å™¨é…ç½®**:
```python
WS_HOST = '0.0.0.0'
WS_PORT = 8765 (å¯é€šè¿‡ç¯å¢ƒå˜é‡WS_PORTé…ç½®)
WS_HEARTBEAT = 5ç§’
```

**å®¢æˆ·ç«¯è¿æ¥å‚æ•°**:
- `log_interval`: æ—¥å¿—æ¨é€é—´éš”(0.1-60ç§’)
- `log_level`: æ—¥å¿—çº§åˆ«è¿‡æ»¤(DEBUG/INFO/WARNING/ERROR/CRITICAL)

**æ”¯æŒçš„æ¶ˆæ¯ç±»å‹**:
```python
MessageTypeæšä¸¾:
â”œâ”€â”€ STATUS_UPDATE          # çŠ¶æ€æ›´æ–°
â”œâ”€â”€ LOG_MESSAGE/LOG_BATCH   # æ—¥å¿—æ¶ˆæ¯
â”œâ”€â”€ ENTITY_UPDATE          # å®ä½“çŠ¶æ€
â”œâ”€â”€ RESOURCE_UPDATE        # èµ„æºçŠ¶æ€  
â”œâ”€â”€ GLOBAL_VAR_UPDATE      # å…¨å±€å˜é‡
â”œâ”€â”€ EVENT_TRIGGERED        # äº‹ä»¶è§¦å‘
â”œâ”€â”€ ACTION_STARTED/COMPLETED # åŠ¨ä½œçŠ¶æ€
â”œâ”€â”€ ACTIVITY_STARTED/COMPLETED # æ´»åŠ¨çŠ¶æ€
â”œâ”€â”€ SIMULATION_STATE_CHANGED # ä»¿çœŸçŠ¶æ€
â””â”€â”€ STEP_COMPLETED         # å•æ­¥å®Œæˆ
```

#### 1.4.4 å¼‚æ­¥äº¤äº’æ¨¡å¼

**è¯·æ±‚-å“åº”æ¨¡å¼**:
```
CommandPost â†’ fire_order â†’ ArtilleryBattalion
                    â†“
           ç¡®è®¤æ¶ˆæ¯(å¯é€‰) â† ArtilleryBattalion
```

**äº‹ä»¶é©±åŠ¨æ¨¡å¼**:
```
å…¨å±€å˜é‡å˜åŒ– â†’ EventSchedulerç›‘æ§ â†’ è§¦å‘ç›¸åº”åŠ¨ä½œ
```

**å¹¿æ’­æ¨¡å¼**:
```
WebSocketæœåŠ¡å™¨ â†’ å¹¿æ’­çŠ¶æ€æ›´æ–° â†’ æ‰€æœ‰è¿æ¥çš„å®¢æˆ·ç«¯
```

### 1.5 èµ„æºåˆ†æ

#### 1.5.1 èµ„æºå®šä¹‰

**res_artillery_roundsï¼ˆç‚®å¼¹å‚¨å¤‡ï¼‰**
```python
èµ„æºç±»å‹: simpy.Container
å®¹é‡(capacity): 200å‘
åˆå§‹é‡(init): 180å‘  
å½“å‰ç”¨æ³•: ç«åŠ›é½å°„æ—¶æ¶ˆè€—36å‘
è®¿é—®æ¨¡å¼: yield ammo.get(rounds_fired)
```

#### 1.5.2 èµ„æºç›‘æ§æœºåˆ¶

**å®æ—¶ç›‘æ§æŒ‡æ ‡**:
```python
{
    "resource_id": "res_artillery_rounds",
    "level": 144,                    # å½“å‰å‰©ä½™é‡
    "capacity": 200,                 # æ€»å®¹é‡
    "utilization": 28.0,             # åˆ©ç”¨ç‡ (200-144)/200*100
    "status": "sufficient|low|depleted"
}
```

**WebSocketæ¨é€**:
- èµ„æºæ¶ˆè€—æ—¶è‡ªåŠ¨æ¨é€RESOURCE_UPDATEæ¶ˆæ¯
- æ”¯æŒå®¢æˆ·ç«¯ä¸»åŠ¨æŸ¥è¯¢èµ„æºçŠ¶æ€

#### 1.5.3 èµ„æºçº¦æŸæ£€æŸ¥

**æ¶ˆè€—å‰æ£€æŸ¥**:
```python
if 'res_artillery_rounds' in resources:
    ammo = resources['res_artillery_rounds']
    if ammo.level >= rounds_fired:
        yield ammo.get(rounds_fired)  # æ‰§è¡Œæ¶ˆè€—
    else:
        log_and_collect('ERROR', f'å¼¹è¯ä¸è¶³ï¼Œéœ€è¦{rounds_fired}å‘ï¼Œå‰©ä½™{ammo.level}å‘')
        return  # ä¸­æ­¢ä»»åŠ¡
```

### 1.6 å…¨å±€å˜é‡åˆ†æ

#### 1.6.1 å…¨å±€å˜é‡å®šä¹‰

| å˜é‡å | ç±»å‹ | åˆå§‹å€¼ | æ›´æ–°æ—¶æœº | å½±å“èŒƒå›´ |
|--------|------|--------|----------|----------|
| **EnemyDetected** | boolean | False | åŒºåŸŸæ‰«æå‘ç°æ•Œæƒ…ã€å‘é€æ•Œæƒ…æŠ¥å‘Š | EventSchedulerç›‘æ§è§¦å‘ |
| **StrikeCompleted** | boolean | False | ç«åŠ›é½å°„å®Œæˆ | è§¦å‘ReconSquadæ¯ä¼¤è¯„ä¼° |
| **DamageAssessment** | double | 0.0 | æ¯ä¼¤è¯„ä¼°æŠ¥å‘Š | ä»»åŠ¡æˆåŠŸåˆ¤æ–­ã€åœç«å†³ç­– |

#### 1.6.2 å˜é‡æ›´æ–°æœºåˆ¶

**çŠ¶æ€ä¸€è‡´æ€§ä¿è¯**:
- æ‰€æœ‰æ›´æ–°éƒ½é€šè¿‡simulation.global_varså­—å…¸
- æ›´æ–°æ—¶å‘é€GLOBAL_VAR_UPDATEæ¶ˆæ¯
- EventSchedulerå®æ—¶ç›‘æ§å˜é‡å˜åŒ–

**æ›´æ–°æ—¶åº**:
```
activity_scan_area: EnemyDetected = True (å‘ç°æ•Œæƒ…æ—¶)
activity_fire_barrage: StrikeCompleted = True (é½å°„å®Œæˆæ—¶)  
activity_report_bda: DamageAssessment = 0.7-1.0 (è¯„ä¼°å®Œæˆæ—¶)
```

#### 1.6.3 äº‹ä»¶è§¦å‘å…³è”

```mermaid
graph LR
    A[EnemyDetected=True] --> B[evt_enemy_detectedè§¦å‘]
    C[DamageAssessmentâ‰¥0.8] --> D[evt_mission_completeè§¦å‘]
    D --> E[è‡ªåŠ¨è§¦å‘åœç«å‘½ä»¤]
```

---

## 2. EATIè¦ç´ æ˜ å°„

### 2.1 ç›´æ¥æ˜ å°„å…³ç³»

| EATI 2.2.1 å…ƒç´  | Pythonå®ç° | å®ç°æ–¹å¼ | æ˜ å°„å®Œæ•´åº¦ |
|------------------|-------------|----------|------------|
| **Tasks** | éšå«ä»»åŠ¡æ¦‚å¿µ | é€šè¿‡å®ä½“åä½œä½“ç°æ•´ä½“ä¾¦å¯Ÿæ‰“å‡»ä»»åŠ¡ | 60% |
| **Entities** | CommandPost, ArtilleryBattalion, ReconSquad | ç»§æ‰¿BaseEntityçš„å®Œæ•´å®ä½“ç±» | 95% |
| **Actions** | ActionPatrol, ActionReportEnemyç­‰7ä¸ªç±» | ç»§æ‰¿ActionBaseçš„åŠ¨ä½œç±» | 90% |
| **Activities** | activity_*ç³»åˆ—13ä¸ªå‡½æ•° | å¸¦è£…é¥°å™¨çš„ç”Ÿæˆå™¨å‡½æ•° | 85% |
| **Interactions** | message_queue + WebSocket | å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—+å®æ—¶é€šä¿¡ | 80% |
| **Resources** | res_artillery_rounds | SimPy Containerèµ„æº | 70% |
| **Events** | EventSchedulerç±» | åŸºäºæ¡ä»¶ç›‘æ§çš„äº‹ä»¶ç³»ç»Ÿ | 75% |
| **Monitors** | MessageCollector + WebSocket | æ•°æ®æ”¶é›†å’Œå®æ—¶æ¨é€ç³»ç»Ÿ | 85% |

### 2.2 å‚æ•°ä¼ é€’æ˜ å°„

**EATIå‚æ•°ä¼ é€’è§„èŒƒ â†’ Pythonå®ç°**:

| EATIè§„èŒƒ | Pythonå®ç° | ç¤ºä¾‹ |
|----------|-------------|------|
| `entity.position` | `entity.position` | å®ä½“ä½ç½®è®¿é—® |
| `global.EnemyDetected` | `simulation.global_vars['EnemyDetected']` | å…¨å±€å˜é‡è®¿é—® |
| `resource.ammunition.level` | `resources['res_artillery_rounds'].level` | èµ„æºçŠ¶æ€è®¿é—® |
| `context.target_position` | `context['target_position']` | ä¸Šä¸‹æ–‡å‚æ•°ä¼ é€’ |
| `event.enemy_info` | `event_context['enemy_info']` | äº‹ä»¶æ•°æ®ä¼ é€’ |

### 2.3 ç¼ºå¤±è¦ç´ åˆ†æ

**éƒ¨åˆ†å®ç°çš„è¦ç´ **:
1. **Tasks**: ç¼ºå°‘æ˜¾å¼ä»»åŠ¡å®šä¹‰ï¼Œé€šè¿‡å®ä½“åä½œéšå«å®ç°
2. **å¤šåˆå§‹åŠ¨ä½œ**: å½“å‰ä¸ºå•ä¸€å¯åŠ¨æ¨¡å¼ï¼Œç¼ºå°‘v2.2.1çš„å¹¶è¡Œ/åˆ†é˜¶æ®µå¯åŠ¨
3. **èµ„æºç±»å‹**: ä»…å®ç°Containerï¼Œç¼ºå°‘PriorityResourceã€PreemptiveResource
4. **äº¤äº’åè®®**: ç¼ºå°‘åŒæ­¥äº¤äº’ã€å¹¿æ’­äº¤äº’æ¨¡å¼
5. **æ—¶é—´åˆ†å¸ƒ**: å®ç°äº†éƒ¨åˆ†åˆ†å¸ƒç±»å‹ï¼Œç¼ºå°‘æˆªæ–­åˆ†å¸ƒç­‰é«˜çº§ç‰¹æ€§

---

## 3. åŠŸèƒ½è¦†ç›–çŸ©é˜µ

### 3.1 è¯¦ç»†è¦†ç›–åˆ†æ

| EATI 2.2.1è¦ç´  | ç¤ºä¾‹å®ç° | è¦†ç›–ç¨‹åº¦ | å·²å®ç°åŠŸèƒ½ | ç¼ºå¤±åŠŸèƒ½ | éªŒè¯è¦ç‚¹ |
|----------------|----------|----------|------------|----------|----------|
| **Tasks** | éšå«ä»»åŠ¡æµç¨‹ | 60% | ä»»åŠ¡æ‰§è¡Œæµç¨‹ã€å®ä½“åä½œ | æ˜¾å¼ä»»åŠ¡å®šä¹‰ã€ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€å¤šåˆå§‹åŠ¨ä½œ | ä»»åŠ¡å®Œæ•´æ€§ã€åä½œæ­£ç¡®æ€§ |
| **Entities** | 3ä¸ªå®Œæ•´å®ä½“ | 95% | å±æ€§ç®¡ç†ã€çŠ¶æ€æ›´æ–°ã€æ¶ˆæ¯å¤„ç†ã€ä½ç½®ç³»ç»Ÿ | å®ä½“ç»§æ‰¿ã€åŠ¨æ€åˆ›å»ºé”€æ¯ | å®ä½“è¡Œä¸ºä¸€è‡´æ€§ã€çŠ¶æ€åŒæ­¥ |
| **Actions** | 7ä¸ªåŠ¨ä½œç±» | 90% | è§¦å‘æ¡ä»¶ã€æ‰§è¡Œæµç¨‹ã€èµ„æºæ£€æŸ¥ã€é”™è¯¯å¤„ç† | åŠ¨ä½œä¼˜å…ˆçº§ã€å¤æ‚ä¸­æ–­é€»è¾‘ | åŠ¨ä½œæ‰§è¡Œé€»è¾‘ã€æ¡ä»¶åˆ¤æ–­ |
| **Activities** | 13ä¸ªæ´»åŠ¨å‡½æ•° | 85% | æ—¶é—´åˆ†å¸ƒã€è¾“å…¥è¾“å‡ºã€è£…é¥°å™¨ç³»ç»Ÿã€æš‚åœæ”¯æŒ | å­æ´»åŠ¨ã€æ¡ä»¶åˆ†æ”¯ã€å¤åˆæ´»åŠ¨ | å‚æ•°ä¼ é€’ã€æ—¶é—´åˆ†å¸ƒæ­£ç¡®æ€§ |
| **Interactions** | æ¶ˆæ¯é˜Ÿåˆ—+WebSocket | 80% | å¼‚æ­¥æ¶ˆæ¯ã€å®æ—¶æ¨é€ã€å¤šå®¢æˆ·ç«¯ | åŒæ­¥äº¤äº’ã€å¹¿æ’­æ¨¡å¼ã€QoS | æ¶ˆæ¯ä¼ é€’å¯é æ€§ã€æ—¶åºæ­£ç¡®æ€§ |
| **Resources** | 1ä¸ªContainerèµ„æº | 70% | å®¹é‡ç®¡ç†ã€æ¶ˆè€—ç›‘æ§ã€çº¦æŸæ£€æŸ¥ | ä¼˜å…ˆçº§èµ„æºã€æŠ¢å èµ„æºã€èµ„æºæ±  | èµ„æºç«äº‰ã€åˆ†é…ç­–ç•¥ |
| **Events** | æ¡ä»¶äº‹ä»¶ç›‘æ§ | 75% | æ¡ä»¶ç›‘æ§ã€è‡ªåŠ¨è§¦å‘ã€äº‹ä»¶æ•°æ® | æ—¶é—´äº‹ä»¶ã€å¤–éƒ¨äº‹ä»¶ã€å¤æ‚æ¡ä»¶ | äº‹ä»¶è§¦å‘æ—¶æœºã€å“åº”æ­£ç¡®æ€§ |
| **Monitors** | å¤šå±‚ç›‘æ§ç³»ç»Ÿ | 85% | çŠ¶æ€ç›‘æ§ã€æ—¥å¿—æ”¶é›†ã€å®æ—¶æ¨é€ã€æ€§èƒ½è¿½è¸ª | å‘Šè­¦é˜ˆå€¼ã€æ•°æ®è¿‡æ»¤ã€èšåˆç»Ÿè®¡ | æ•°æ®å®Œæ•´æ€§ã€æ¨é€åŠæ—¶æ€§ |
| **GlobalVariables** | 3ä¸ªå…¨å±€å˜é‡ | 90% | çŠ¶æ€ç®¡ç†ã€æ›´æ–°é€šçŸ¥ã€è®¿é—®æ§åˆ¶ | å˜é‡éªŒè¯ã€ç±»å‹æ£€æŸ¥ã€æƒé™æ§åˆ¶ | çŠ¶æ€ä¸€è‡´æ€§ã€æ›´æ–°æ—¶åº |
| **TimeDistribution** | 4ç§åˆ†å¸ƒç±»å‹ | 80% | å¸¸é‡ã€æŒ‡æ•°ã€æ­£æ€ã€å‡åŒ€åˆ†å¸ƒ | æˆªæ–­åˆ†å¸ƒã€ç›¸å…³åˆ†å¸ƒã€å‚æ•°éªŒè¯ | éšæœºæ€§æ­£ç¡®æ€§ã€åˆ†å¸ƒå‚æ•° |
| **SimulationConfig** | å®Œæ•´é…ç½®ç³»ç»Ÿ | 95% | æ—¶é—´æ§åˆ¶ã€éšæœºç§å­ã€è¿è¡Œæ¨¡å¼ã€å®æ—¶æ¯”ä¾‹ | åŠ¨æ€é…ç½®ã€é…ç½®éªŒè¯ | ä»¿çœŸå‚æ•°æ­£ç¡®æ€§ |
| **ExpressionEvaluator** | å®‰å…¨è¡¨è¾¾å¼è®¡ç®— | 85% | æ•°å­¦å‡½æ•°ã€å˜é‡å¼•ç”¨ã€å®‰å…¨æ‰§è¡Œ | å¤æ‚è¡¨è¾¾å¼ã€æ€§èƒ½ä¼˜åŒ– | è®¡ç®—ç»“æœæ­£ç¡®æ€§ã€å®‰å…¨æ€§ |

### 3.2 å…³é”®éªŒè¯ç‚¹çŸ©é˜µ

| åŠŸèƒ½åŸŸ | æ ¸å¿ƒéªŒè¯ç‚¹ | æµ‹è¯•æ–¹æ³• | æœŸæœ›ç»“æœ |
|--------|------------|----------|----------|
| **å®ä½“ç³»ç»Ÿ** | çŠ¶æ€åŒæ­¥ã€æ¶ˆæ¯å¤„ç†ã€ä½ç½®æ›´æ–° | å•å…ƒæµ‹è¯•+é›†æˆæµ‹è¯• | çŠ¶æ€ä¸€è‡´ã€æ¶ˆæ¯æ— ä¸¢å¤± |
| **åŠ¨ä½œç³»ç»Ÿ** | è§¦å‘æ¡ä»¶ã€æ‰§è¡Œé¡ºåºã€èµ„æºæ£€æŸ¥ | åœºæ™¯æµ‹è¯• | é€»è¾‘æ­£ç¡®ã€èµ„æºå®‰å…¨ |
| **æ´»åŠ¨ç³»ç»Ÿ** | æ—¶é—´åˆ†å¸ƒã€å‚æ•°ä¼ é€’ã€å¼‚å¸¸å¤„ç† | ç»Ÿè®¡æµ‹è¯•+è¾¹ç•Œæµ‹è¯• | åˆ†å¸ƒæ­£ç¡®ã€å‚æ•°å®Œæ•´ |
| **äº¤äº’ç³»ç»Ÿ** | æ¶ˆæ¯æ—¶åºã€æ•°æ®å®Œæ•´æ€§ã€è¿æ¥ç¨³å®šæ€§ | å¹¶å‘æµ‹è¯•+å‹åŠ›æµ‹è¯• | æ—¶åºæ­£ç¡®ã€æ•°æ®å®Œæ•´ |
| **èµ„æºç³»ç»Ÿ** | å¹¶å‘è®¿é—®ã€çº¦æŸæ£€æŸ¥ã€çŠ¶æ€ç›‘æ§ | å¹¶å‘æµ‹è¯•+èµ„æºè€—å°½æµ‹è¯• | è®¿é—®å®‰å…¨ã€çº¦æŸæœ‰æ•ˆ |
| **äº‹ä»¶ç³»ç»Ÿ** | è§¦å‘æ—¶æœºã€æ¡ä»¶åˆ¤æ–­ã€å“åº”é€Ÿåº¦ | äº‹ä»¶åºåˆ—æµ‹è¯• | æ—¶æœºå‡†ç¡®ã€å“åº”åŠæ—¶ |

---

## 4. SimPyé¢„æœŸè¡Œä¸ºè§„èŒƒ

### 4.1 æ ‡å‡†æ‰§è¡Œæ—¶åº

#### 4.1.1 æˆåŠŸåœºæ™¯æ—¶åºå›¾

```mermaid
gantt
    title ä¾¦å¯Ÿ-ç«åŠ›æ‰“å‡»ä»¿çœŸæ—¶åºå›¾
    dateFormat X
    axisFormat %s
    
    section ä¾¦å¯Ÿé˜¶æ®µ
    å·¡é€»ç§»åŠ¨      :0, 30
    åŒºåŸŸæ‰«æ      :30, 40
    æ”¶é›†æƒ…æŠ¥      :40, 80
    å‘é€æŠ¥å‘Š      :80, 85
    
    section å†³ç­–é˜¶æ®µ  
    åˆ†ææŠ¥å‘Š      :85, 115
    åˆ¶å®šå†³ç­–      :115, 135
    å‡†å¤‡å‘½ä»¤      :135, 150
    ä¼ é€å‘½ä»¤      :150, 155
    
    section ç«åŠ›é˜¶æ®µ
    å‡†å¤‡ç«ç‚®      :155, 215
    ç«åŠ›é½å°„      :215, 335
    
    section è¯„ä¼°é˜¶æ®µ
    è§‚å¯Ÿæ•ˆæœ      :335, 395
    æŠ¥å‘Šæ¯ä¼¤      :395, 405
    è¯„ä¼°ç»“æœ      :405, 425
    åœç«å‘½ä»¤      :425, 430
```

#### 4.1.2 å…³é”®æ—¶é—´èŠ‚ç‚¹

| æ—¶é—´(ç§’) | äº‹ä»¶ | å®ä½“ | çŠ¶æ€å˜åŒ– | å…¨å±€å½±å“ |
|----------|------|------|----------|----------|
| 0 | ä»¿çœŸå¼€å§‹ | All | åˆå§‹åŒ–çŠ¶æ€ | - |
| 30-40 | åŒºåŸŸæ‰«æ | ReconSquad | å¯èƒ½å‘ç°æ•Œæƒ… | EnemyDetectedå¯èƒ½å˜True |
| 85 | æ•Œæƒ…æŠ¥å‘Š | ReconSquadâ†’CommandPost | å‘é€æ¶ˆæ¯ | EnemyDetected=True |
| 135 | ç«åŠ›å†³ç­– | CommandPost | å†³å®šå¼€ç« | è§¦å‘ç«åŠ›å‘½ä»¤ |
| 155 | ç«åŠ›å‡†å¤‡ | ArtilleryBattalion | fire_status='preparing' | - |
| 215 | å¼€å§‹å°„å‡» | ArtilleryBattalion | fire_status='firing' | å¼€å§‹æ¶ˆè€—å¼¹è¯ |
| 335 | å°„å‡»å®Œæˆ | ArtilleryBattalion | fire_status='ready' | StrikeCompleted=True |
| 405 | æ¯ä¼¤è¯„ä¼° | ReconSquad | å®Œæˆè¯„ä¼° | DamageAssessment=0.7-1.0 |
| 425 | ä»»åŠ¡å®Œæˆ | CommandPost | è¯„ä¼°æˆåŠŸ | è§¦å‘åœç«å‘½ä»¤ |

#### 4.1.3 æ¦‚ç‡æ€§äº‹ä»¶å¤„ç†

**æ•Œæƒ…å‘ç°æ¦‚ç‡**: æ¯æ¬¡æ‰«æ30%æ¦‚ç‡å‘ç°
- æœŸæœ›å‘ç°æ—¶é—´: 30 + 10/0.3 â‰ˆ 63ç§’
- æœ€å¤§å°è¯•æ¬¡æ•°: 10æ¬¡ï¼ˆé¿å…æ— é™å¾ªç¯ï¼‰

**å¨èƒè¯„ä¼°éšæœºæ€§**: åŸºäºæ•Œå†›ç±»å‹çš„å¨èƒè®¡ç®—
```python
å¨èƒç­‰çº§è®¡ç®—:
if strength == 'company': return 0.8    # 80%æ¦‚ç‡å¼€ç«
elif strength == 'platoon': return 0.5  # 50%æ¦‚ç‡å¼€ç«  
else: return 0.3                        # 30%æ¦‚ç‡å¼€ç«
```

**æ¯ä¼¤è¯„ä¼°éšæœºæ€§**: 0.7-1.0å‡åŒ€åˆ†å¸ƒ
- æˆåŠŸé˜ˆå€¼: â‰¥0.8 (çº¦50%æ¦‚ç‡æˆåŠŸ)

### 4.2 èµ„æºæ¶ˆè€—æ¨¡å¼

#### 4.2.1 å¼¹è¯æ¶ˆè€—åˆ†æ

**æ¶ˆè€—æ—¶åº**:
```
T=0:    åˆå§‹180å‘
T=215:  æ£€æŸ¥å¼¹è¯å……è¶³æ€§ (éœ€è¦36å‘)
T=215-335: åˆ†4é˜¶æ®µæ¶ˆè€—ï¼Œæ¯é˜¶æ®µ9å‘
T=335:  æœ€ç»ˆ144å‘ï¼Œåˆ©ç”¨ç‡28%
```

**çº¦æŸæ£€æŸ¥**:
```python
æ¶ˆè€—å‰æ£€æŸ¥:
if ammo.level >= rounds_needed:
    yield ammo.get(rounds_needed)
else:
    log_error("å¼¹è¯ä¸è¶³")
    return  # ä¸­æ­¢ä»»åŠ¡
```

**ç›‘æ§æ¨é€**:
```python
æ¯æ¬¡æ¶ˆè€—åæ¨é€:
{
    "type": "RESOURCE_UPDATE",
    "data": {
        "resource_id": "res_artillery_rounds",
        "level": 144,
        "capacity": 200,  
        "utilization": 28.0
    }
}
```

#### 4.2.2 é€šä¿¡èµ„æºä½¿ç”¨

**æ¶ˆæ¯é˜Ÿåˆ—æ€§èƒ½**:
- æ¶ˆæ¯ä¼ é€’: ç¬æ—¶å®Œæˆï¼ˆä»¿çœŸæ—¶é—´å†…ï¼‰
- é˜Ÿåˆ—å®¹é‡: æ— é™åˆ¶ï¼ˆSimPy Storeé»˜è®¤ï¼‰
- æ¶ˆæ¯ç”Ÿå‘½å‘¨æœŸ: å‘é€â†’æ¥æ”¶â†’å¤„ç†â†’å“åº”

**WebSocketè¿æ¥ç®¡ç†**:
- å¹¶å‘è¿æ¥: æ”¯æŒå¤šå®¢æˆ·ç«¯
- æ¨é€é¢‘ç‡: å¯é…ç½®(0.1-60ç§’)
- ç¼“å­˜ç®¡ç†: æœ€å¤šä¿ç•™1000æ¡æ¶ˆæ¯

### 4.3 çŠ¶æ€è½¬æ¢è§„èŒƒ

#### 4.3.1 å®ä½“çŠ¶æ€æœº

**ReconSquadçŠ¶æ€è½¬æ¢**:
```mermaid
stateDiagram-v2
    [*] --> Patrolling
    Patrolling --> EnemyContact : å‘ç°æ•Œæƒ…
    EnemyContact --> GatheringIntel : æ”¶é›†æƒ…æŠ¥
    GatheringIntel --> ReportingEnemy : å‘é€æŠ¥å‘Š
    ReportingEnemy --> Patrolling : ç»§ç»­å·¡é€»
    
    Patrolling --> AssessingDamage : StrikeCompleted=True
    AssessingDamage --> ReportingBDA : è¯„ä¼°å®Œæˆ
    ReportingBDA --> Patrolling : è¿”å›å·¡é€»
```

**ArtilleryBattalionçŠ¶æ€è½¬æ¢**:
```mermaid
stateDiagram-v2
    [*] --> Ready
    Ready --> Preparing : æ”¶åˆ°fire_order
    Preparing --> Firing : å‡†å¤‡å®Œæˆ
    Firing --> Ready : å°„å‡»å®Œæˆ
    Ready --> Ceased : æ”¶åˆ°cease_fire
    Ceased --> Ready : çŠ¶æ€æŠ¥å‘Šå®Œæˆ
```

#### 4.3.2 å…¨å±€çŠ¶æ€ä¸€è‡´æ€§

**çŠ¶æ€ä¾èµ–å…³ç³»**:
```
EnemyDetected=True â† activity_scan_area OR activity_send_enemy_report
StrikeCompleted=True â† activity_fire_barrageå®Œæˆ
DamageAssessment>0 â† activity_report_bdaå®Œæˆ
```

**çŠ¶æ€éªŒè¯è§„åˆ™**:
- EnemyDetectedä¸ºTrueæ—¶ï¼Œå¿…é¡»æœ‰å®ä½“å¤„äºenemy_contactçŠ¶æ€
- StrikeCompletedä¸ºTrueæ—¶ï¼Œç‚®å…µè¥rounds_fired>0
- DamageAssessment>0æ—¶ï¼ŒStrikeCompletedå¿…é¡»ä¸ºTrue

### 4.4 å¼‚å¸¸å¤„ç†è§„èŒƒ

#### 4.4.1 å¼‚å¸¸åœºæ™¯å®šä¹‰

| å¼‚å¸¸ç±»å‹ | è§¦å‘æ¡ä»¶ | å¤„ç†ç­–ç•¥ | æ¢å¤æœºåˆ¶ |
|----------|----------|----------|----------|
| **å¼¹è¯ä¸è¶³** | ammo.level < 36 | è®°å½•é”™è¯¯ï¼Œä¸­æ­¢å°„å‡» | ç­‰å¾…è¡¥ç»™æˆ–é™ä½éœ€æ±‚ |
| **é€šä¿¡ä¸­æ–­** | æ¶ˆæ¯å‘é€å¤±è´¥ | é‡è¯•æœºåˆ¶ï¼Œè¶…æ—¶å¤„ç† | é‡æ–°å»ºç«‹è¿æ¥ |
| **æ´»åŠ¨å¼‚å¸¸** | æ´»åŠ¨æ‰§è¡Œå‡ºé”™ | è®°å½•å¼‚å¸¸ï¼ŒçŠ¶æ€å›æ»š | é‡ç½®å®ä½“çŠ¶æ€ |
| **WebSocketæ–­å¼€** | å®¢æˆ·ç«¯è¿æ¥ä¸¢å¤± | æ¸…ç†è¿æ¥ï¼Œåœæ­¢æ¨é€ | è‡ªåŠ¨é‡è¿æœºåˆ¶ |

#### 4.4.2 é”™è¯¯æ¢å¤æœºåˆ¶

**å®ä½“çº§é”™è¯¯å¤„ç†**:
```python
try:
    yield self.env.process(activity_func(env, entity, context))
except Exception as e:
    log_and_collect('ERROR', f'æ´»åŠ¨å¼‚å¸¸: {str(e)}', entity=entity.name)
    entity.reset_state()  # çŠ¶æ€é‡ç½®
    raise  # å¯é€‰æ‹©ç»§ç»­æŠ›å‡ºæˆ–åæ²¡å¼‚å¸¸
```

**ç³»ç»Ÿçº§é”™è¯¯å¤„ç†**:
- ä»¿çœŸæš‚åœæœºåˆ¶: é‡åˆ°ä¸¥é‡é”™è¯¯æ—¶æš‚åœä»¿çœŸ
- çŠ¶æ€å¿«ç…§: å®šæœŸä¿å­˜ä»¿çœŸçŠ¶æ€ç”¨äºæ¢å¤
- æ—¥å¿—è®°å½•: å®Œæ•´çš„é”™è¯¯è°ƒç”¨æ ˆå’Œä¸Šä¸‹æ–‡ä¿¡æ¯

---

## 5. é»„é‡‘æœŸæœ›ï¼ˆGolden Expectationsï¼‰

### 5.1 é‡åŒ–éªŒè¯æ ‡å‡†

#### 5.1.1 æœ€ç»ˆçŠ¶æ€æœŸæœ›

```python
# æˆåŠŸåœºæ™¯çš„æœŸæœ›æœ€ç»ˆçŠ¶æ€
EXPECTED_FINAL_STATE = {
    "simulation_info": {
        "total_time": 1800,           # æœ€å¤§ä»¿çœŸæ—¶é—´
        "actual_end_time": 425,       # å®é™…ç»“æŸæ—¶é—´ (Â±50s)
        "completion_rate": 0.236,     # å®Œæˆåº¦ 425/1800
        "success": True               # ä»»åŠ¡æˆåŠŸæ ‡å¿—
    },
    
    "global_variables": {
        "EnemyDetected": True,        # å¿…é¡»å‘ç°æ•Œæƒ…
        "StrikeCompleted": True,      # å¿…é¡»å®Œæˆæ‰“å‡»
        "DamageAssessment": 0.85      # æ¯ä¼¤è¯„ä¼° (â‰¥0.8ä¸ºæˆåŠŸ)
    },
    
    "entities_final_state": {
        "ent_command_post": {
            "name": "æŒ‡æŒ¥æ‰€",
            "alert_level": 1,
            "last_action": "act_cease_fire_order"
        },
        "ent_artillery_battalion": {
            "name": "ç‚®å…µè¥", 
            "fire_status": "ready",
            "rounds_fired": 36,
            "last_action": "act_cease_fire"
        },
        "ent_recon_squad": {
            "name": "æ­¥å…µä¾¦å¯Ÿç­",
            "enemy_contact": True,
            "patrol_status": "patrolling",
            "last_action": "act_assess_damage"
        }
    },
    
    "resources_final_state": {
        "res_artillery_rounds": {
            "level": 144,             # 180 - 36
            "capacity": 200,
            "utilization": 28.0,      # (200-144)/200*100
            "consumption_events": 1   # ä¸€æ¬¡å¤§è§„æ¨¡æ¶ˆè€—
        }
    }
}
```

#### 5.1.2 å…³é”®äº‹ä»¶åºåˆ—æœŸæœ›

```python
EXPECTED_EVENT_SEQUENCE = [
    {
        "event": "simulation_start",
        "time_range": [0, 0],
        "entities": ["all"],
        "verification": "æ‰€æœ‰å®ä½“åˆå§‹åŒ–å®Œæˆ"
    },
    {
        "event": "enemy_detection", 
        "time_range": [30, 100],     # 30%æ¦‚ç‡ï¼ŒæœŸæœ›3.33æ¬¡å°è¯•
        "entities": ["ent_recon_squad"],
        "verification": "global_vars['EnemyDetected'] == True"
    },
    {
        "event": "intel_analysis",
        "time_range": [85, 120],
        "entities": ["ent_command_post"],  
        "verification": "å¨èƒç­‰çº§è®¡ç®—å®Œæˆ"
    },
    {
        "event": "fire_decision",
        "time_range": [115, 150],
        "entities": ["ent_command_post"],
        "verification": "fire_decision == True (å¨èƒ>0.6)"
    },
    {
        "event": "fire_preparation",
        "time_range": [155, 215],
        "entities": ["ent_artillery_battalion"],
        "verification": "fire_status == 'preparing'"
    },
    {
        "event": "fire_execution", 
        "time_range": [215, 335],
        "entities": ["ent_artillery_battalion"],
        "verification": "å¼¹è¯æ¶ˆè€—36å‘, fire_status == 'firing'"
    },
    {
        "event": "strike_completion",
        "time_range": [335, 335],
        "entities": ["ent_artillery_battalion"],
        "verification": "global_vars['StrikeCompleted'] == True"
    },
    {
        "event": "damage_assessment",
        "time_range": [335, 450],
        "entities": ["ent_recon_squad"],
        "verification": "global_vars['DamageAssessment'] >= 0.8"
    },
    {
        "event": "mission_completion",
        "time_range": [405, 500],
        "entities": ["ent_command_post"],
        "verification": "åœç«å‘½ä»¤å‘é€, ä»»åŠ¡æˆåŠŸ"
    }
]
```

#### 5.1.3 æ€§èƒ½æŒ‡æ ‡æœŸæœ›

```python
EXPECTED_PERFORMANCE_METRICS = {
    "execution_time": {
        "simulation_time": 425,       # ä»¿çœŸå†…æ—¶é—´(ç§’)
        "real_time": 85,             # å®é™…æ‰§è¡Œæ—¶é—´(ç§’) = 425/5
        "time_ratio": 5.0,           # 5å€é€Ÿè¿è¡Œ
        "step_mode_overhead": 0.1    # å•æ­¥æ¨¡å¼é¢å¤–å¼€é”€
    },
    
    "resource_usage": {
        "memory_peak": "< 100MB",    # å³°å€¼å†…å­˜ä½¿ç”¨
        "message_count": "< 1000",   # æ€»æ¶ˆæ¯æ•°é‡
        "log_entries": "< 500",      # æ—¥å¿—æ¡ç›®æ•°
        "websocket_connections": 5   # æœ€å¤§å¹¶å‘è¿æ¥æ•°
    },
    
    "communication_metrics": {
        "message_latency": "< 0.1s", # æ¶ˆæ¯ä¼ é€’å»¶è¿Ÿ(ä»¿çœŸæ—¶é—´)
        "websocket_push_interval": 1.0, # WebSocketæ¨é€é—´éš”
        "log_push_batch_size": 30,   # æ‰¹é‡æ¨é€å¤§å°
        "connection_stability": "99%" # è¿æ¥ç¨³å®šæ€§
    },
    
    "activity_execution_stats": {
        "total_activities": 13,      # æ´»åŠ¨å‡½æ•°æ€»æ•°
        "activity_executions": ">20", # æ´»åŠ¨æ‰§è¡Œæ€»æ¬¡æ•°
        "average_activity_duration": 25.0, # å¹³å‡æ´»åŠ¨è€—æ—¶
        "activity_success_rate": "100%" # æ´»åŠ¨æˆåŠŸç‡
    }
}
```

### 5.2 æ¦‚ç‡æ€§éªŒè¯æ ‡å‡†

#### 5.2.1 éšæœºäº‹ä»¶éªŒè¯

**æ•Œæƒ…å‘ç°æ¦‚ç‡éªŒè¯** (100æ¬¡è¿è¡Œç»Ÿè®¡):
```python
PROBABILITY_EXPECTATIONS = {
    "enemy_detection": {
        "probability": 0.3,          # æ¯æ¬¡æ‰«æ30%
        "expected_attempts": 3.33,   # æœŸæœ›å°è¯•æ¬¡æ•° 1/0.3
        "max_attempts": 10,          # æœ€å¤§å°è¯•æ¬¡æ•°é™åˆ¶
        "success_rate": ">95%",      # 100æ¬¡è¿è¡Œä¸­95%ä»¥ä¸Šå‘ç°æ•Œæƒ…
        "time_range": [30, 130]      # å‘ç°æ—¶é—´èŒƒå›´
    },
    
    "threat_assessment": {
        "company_threat": 0.8,       # è¿çº§ç›®æ ‡å¨èƒç­‰çº§
        "fire_probability": 0.8,     # å¼€ç«æ¦‚ç‡ (å¨èƒ>0.6)
        "variance": 0.1              # å…è®¸çš„æ–¹å·®èŒƒå›´
    },
    
    "damage_assessment": {
        "distribution": "uniform",    # å‡åŒ€åˆ†å¸ƒ
        "range": [0.7, 1.0],         # æ¯ä¼¤èŒƒå›´
        "success_threshold": 0.8,     # æˆåŠŸé˜ˆå€¼
        "success_probability": 0.67   # ç†è®ºæˆåŠŸæ¦‚ç‡ (1.0-0.8)/(1.0-0.7)
    }
}
```

#### 5.2.2 æ—¶é—´åˆ†å¸ƒéªŒè¯

**æ´»åŠ¨æ—¶é—´åˆ†å¸ƒæ£€éªŒ**:
```python
TIME_DISTRIBUTION_TESTS = {
    "activity_gather_intel": {
        "distribution": "uniform",
        "parameters": {"min": 20.0, "max": 40.0},
        "expected_mean": 30.0,
        "expected_std": 5.77,        # sqrt((40-20)Â²/12)
        "sample_size": 100,
        "tolerance": 0.1
    },
    
    "activity_fire_barrage": {
        "distribution": "constant", 
        "parameters": {"value": 120.0},
        "expected_mean": 120.0,
        "expected_std": 0.0,
        "sample_size": 100,
        "tolerance": 0.01
    }
}
```

### 5.3 å¯å¤ç°å®éªŒè„šæœ¬

#### 5.3.1 ç«¯åˆ°ç«¯éªŒè¯è„šæœ¬

```python
def test_reconnaissance_fire_mission_e2e():
    """
    ç«¯åˆ°ç«¯éªŒè¯è„šæœ¬ - ä¾¦å¯Ÿç«åŠ›æ‰“å‡»ä»¿çœŸ
    éªŒè¯å®Œæ•´ä»»åŠ¡æµç¨‹ä»æ•Œæƒ…å‘ç°åˆ°ä»»åŠ¡å®Œæˆ
    """
    
    # 1. ç¯å¢ƒåˆå§‹åŒ–
    random.seed(GOLDEN_SEED)
    np.random.seed(GOLDEN_SEED)
    
    simulation = EATISimulation()
    simulation.setup()
    
    # 2. ç›‘æ§å™¨è®¾ç½®
    state_monitor = SimulationStateMonitor()
    event_monitor = EventSequenceMonitor() 
    performance_monitor = PerformanceMonitor()
    resource_monitor = ResourceConsumptionMonitor()
    
    # 3. æ‰§è¡Œä»¿çœŸ
    start_time = time.time()
    simulation.run()
    execution_time = time.time() - start_time
    
    # 4. éªŒè¯æœ€ç»ˆçŠ¶æ€
    final_state = simulation.get_simulation_status()
    assert_final_state_matches_expectation(final_state, EXPECTED_FINAL_STATE)
    
    # 5. éªŒè¯äº‹ä»¶åºåˆ—
    event_sequence = event_monitor.get_event_sequence()
    assert_event_sequence_valid(event_sequence, EXPECTED_EVENT_SEQUENCE)
    
    # 6. éªŒè¯èµ„æºæ¶ˆè€—
    resource_consumption = resource_monitor.get_consumption_log()
    assert_resource_consumption_correct(resource_consumption)
    
    # 7. éªŒè¯æ€§èƒ½æŒ‡æ ‡
    performance_metrics = performance_monitor.get_metrics()
    assert_performance_within_bounds(performance_metrics, EXPECTED_PERFORMANCE_METRICS)
    
    # 8. éªŒè¯æ¦‚ç‡æ€§è¡Œä¸º
    assert_probability_behaviors_correct(simulation)
    
    print("âœ“ ç«¯åˆ°ç«¯éªŒè¯é€šè¿‡")
    return True

def assert_final_state_matches_expectation(actual, expected):
    """éªŒè¯æœ€ç»ˆçŠ¶æ€åŒ¹é…æœŸæœ›"""
    
    # éªŒè¯å…¨å±€å˜é‡
    assert actual['global_vars']['EnemyDetected'] == expected['global_variables']['EnemyDetected']
    assert actual['global_vars']['StrikeCompleted'] == expected['global_variables']['StrikeCompleted'] 
    assert actual['global_vars']['DamageAssessment'] >= expected['global_variables']['DamageAssessment']
    
    # éªŒè¯å®ä½“çŠ¶æ€
    for entity_id, expected_entity in expected['entities_final_state'].items():
        actual_entity = actual['entities'][entity_id]
        assert actual_entity['name'] == expected_entity['name']
        
        if entity_id == 'ent_artillery_battalion':
            assert actual_entity['rounds_fired'] == expected_entity['rounds_fired']
            assert actual_entity['fire_status'] == expected_entity['fire_status']
    
    # éªŒè¯èµ„æºçŠ¶æ€
    for resource_id, expected_resource in expected['resources_final_state'].items():
        actual_resource = actual['resources'][resource_id]
        assert actual_resource['level'] == expected_resource['level']
        assert actual_resource['utilization'] == expected_resource['utilization']
    
    print("âœ“ æœ€ç»ˆçŠ¶æ€éªŒè¯é€šè¿‡")

def assert_event_sequence_valid(actual_events, expected_sequence):
    """éªŒè¯äº‹ä»¶åºåˆ—æœ‰æ•ˆæ€§"""
    
    for expected_event in expected_sequence:
        # æŸ¥æ‰¾å¯¹åº”äº‹ä»¶
        matching_events = [e for e in actual_events if e['type'] == expected_event['event']]
        assert len(matching_events) > 0, f"æœªæ‰¾åˆ°æœŸæœ›äº‹ä»¶: {expected_event['event']}"
        
        # éªŒè¯æ—¶é—´èŒƒå›´
        event_time = matching_events[0]['time']
        time_range = expected_event['time_range']
        assert time_range[0] <= event_time <= time_range[1], \
            f"äº‹ä»¶{expected_event['event']}æ—¶é—´{event_time}ä¸åœ¨æœŸæœ›èŒƒå›´{time_range}"
    
    print("âœ“ äº‹ä»¶åºåˆ—éªŒè¯é€šè¿‡")

def assert_resource_consumption_correct(consumption_log):
    """éªŒè¯èµ„æºæ¶ˆè€—æ­£ç¡®æ€§"""
    
    # éªŒè¯å¼¹è¯æ¶ˆè€—
    ammo_events = [e for e in consumption_log if e['resource'] == 'res_artillery_rounds']
    assert len(ammo_events) == 1, "åº”è¯¥åªæœ‰ä¸€æ¬¡å¼¹è¯æ¶ˆè€—äº‹ä»¶"
    
    ammo_consumption = ammo_events[0]
    assert ammo_consumption['amount'] == 36, "å¼¹è¯æ¶ˆè€—é‡åº”ä¸º36å‘"
    assert ammo_consumption['remaining'] == 144, "å‰©ä½™å¼¹è¯åº”ä¸º144å‘"
    
    print("âœ“ èµ„æºæ¶ˆè€—éªŒè¯é€šè¿‡")
```

#### 5.3.2 è¾¹ç•Œæ¡ä»¶æµ‹è¯•è„šæœ¬

```python
def test_boundary_conditions():
    """è¾¹ç•Œæ¡ä»¶æµ‹è¯•é›†åˆ"""
    
    test_insufficient_ammunition()
    test_low_threat_scenario()
    test_insufficient_damage() 
    test_communication_failure()
    test_random_seed_reproducibility()

def test_insufficient_ammunition():
    """æµ‹è¯•å¼¹è¯ä¸è¶³åœºæ™¯"""
    
    simulation = EATISimulation()
    simulation.setup()
    
    # äººä¸ºé™ä½å¼¹è¯å‚¨å¤‡
    simulation.resources['res_artillery_rounds']._capacity = 30
    simulation.resources['res_artillery_rounds']._level = 30
    
    # å¼ºåˆ¶è§¦å‘æ•Œæƒ…å‘ç°
    force_enemy_detection(simulation)
    
    # æ‰§è¡Œä»¿çœŸ
    simulation.run()
    
    # éªŒè¯ç»“æœï¼šåº”è¯¥è®°å½•å¼¹è¯ä¸è¶³é”™è¯¯ï¼Œä»»åŠ¡æœªå®Œæˆ
    final_state = simulation.get_simulation_status()
    assert final_state['global_vars']['StrikeCompleted'] == False
    assert final_state['entities']['ent_artillery_battalion']['rounds_fired'] == 0
    
    print("âœ“ å¼¹è¯ä¸è¶³åœºæ™¯éªŒè¯é€šè¿‡")

def test_random_seed_reproducibility():
    """æµ‹è¯•éšæœºç§å­å¯é‡ç°æ€§"""
    
    results = []
    for i in range(3):
        random.seed(123)
        np.random.seed(123)
        
        simulation = EATISimulation()
        simulation.setup()
        simulation.run()
        
        results.append(simulation.get_simulation_status())
    
    # éªŒè¯ä¸‰æ¬¡è¿è¡Œç»“æœå®Œå…¨ä¸€è‡´
    for i in range(1, 3):
        assert results[i]['global_vars'] == results[0]['global_vars']
        assert results[i]['simulation_time'] == results[0]['simulation_time']
    
    print("âœ“ éšæœºç§å­å¯é‡ç°æ€§éªŒè¯é€šè¿‡")
```

#### 5.3.3 æ€§èƒ½åŸºå‡†æµ‹è¯•

```python
def benchmark_simulation_performance():
    """ä»¿çœŸæ€§èƒ½åŸºå‡†æµ‹è¯•"""
    
    benchmark_results = {}
    
    # 1. æ‰§è¡Œæ—¶é—´åŸºå‡†
    execution_times = []
    for i in range(10):
        start_time = time.time()
        simulation = EATISimulation()
        simulation.setup()
        simulation.run()
        execution_times.append(time.time() - start_time)
    
    benchmark_results['execution_time'] = {
        'mean': np.mean(execution_times),
        'std': np.std(execution_times),
        'min': np.min(execution_times),
        'max': np.max(execution_times)
    }
    
    # 2. å†…å­˜ä½¿ç”¨åŸºå‡†
    import psutil
    process = psutil.Process()
    
    memory_before = process.memory_info().rss
    simulation = EATISimulation()
    simulation.setup()
    simulation.run()
    memory_after = process.memory_info().rss
    
    benchmark_results['memory_usage'] = {
        'peak_mb': (memory_after - memory_before) / 1024 / 1024,
        'baseline_mb': memory_before / 1024 / 1024
    }
    
    # 3. WebSocketæ€§èƒ½åŸºå‡†
    benchmark_results['websocket_performance'] = benchmark_websocket_performance()
    
    # 4. æ¶ˆæ¯å¤„ç†æ€§èƒ½åŸºå‡†  
    benchmark_results['message_performance'] = benchmark_message_processing()
    
    # éªŒè¯æ€§èƒ½æŒ‡æ ‡åœ¨æœŸæœ›èŒƒå›´å†…
    assert_performance_benchmarks_acceptable(benchmark_results)
    
    return benchmark_results

def assert_performance_benchmarks_acceptable(results):
    """éªŒè¯æ€§èƒ½åŸºå‡†å¯æ¥å—"""
    
    # æ‰§è¡Œæ—¶é—´åº”åœ¨åˆç†èŒƒå›´å†…
    assert results['execution_time']['mean'] < 15.0, "å¹³å‡æ‰§è¡Œæ—¶é—´è¿‡é•¿"
    assert results['execution_time']['std'] < 2.0, "æ‰§è¡Œæ—¶é—´æ–¹å·®è¿‡å¤§"
    
    # å†…å­˜ä½¿ç”¨åº”åœ¨åˆç†èŒƒå›´å†…  
    assert results['memory_usage']['peak_mb'] < 100, "å†…å­˜ä½¿ç”¨è¿‡é«˜"
    
    # WebSocketæ€§èƒ½åº”æ»¡è¶³è¦æ±‚
    assert results['websocket_performance']['avg_latency'] < 0.1, "WebSocketå»¶è¿Ÿè¿‡é«˜"
    
    print("âœ“ æ€§èƒ½åŸºå‡†éªŒè¯é€šè¿‡")
```

---

## æ€»ç»“

### é¡¹ç›®åˆ†ææˆæœ

æœ¬åˆ†ææŠ¥å‘Šå…¨é¢æ‹†è§£äº†ä¾¦å¯Ÿ-ç«åŠ›æ‰“å‡»ä»¿çœŸç¤ºä¾‹ï¼Œå»ºç«‹äº†ä»Python SimPyå®ç°åˆ°EATI Schema 2.2.1çš„å®Œæ•´æ˜ å°„å…³ç³»ã€‚ä¸»è¦æˆæœåŒ…æ‹¬ï¼š

#### âœ… æ„ä»¶è¦†ç›–å®Œæ•´æ€§
- **å®ä½“ç³»ç»Ÿ**: 3ä¸ªå®Œæ•´å®ä½“ç±»ï¼Œè¦†ç›–ä¸»åŠ¨/è¢«åŠ¨å®ä½“æ¨¡å¼
- **åŠ¨ä½œç³»ç»Ÿ**: 7ä¸ªåŠ¨ä½œç±»ï¼Œæ¶µç›–æ¡ä»¶è§¦å‘ã€èµ„æºæ£€æŸ¥ã€é”™è¯¯å¤„ç†
- **æ´»åŠ¨ç³»ç»Ÿ**: 13ä¸ªæ´»åŠ¨å‡½æ•°ï¼ŒåŒ…å«å¤šç§æ—¶é—´åˆ†å¸ƒå’Œå‚æ•°ä¼ é€’
- **äº¤äº’ç³»ç»Ÿ**: å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ— + WebSocketå®æ—¶é€šä¿¡
- **èµ„æºç³»ç»Ÿ**: Containerèµ„æºæ¨¡å¼ï¼Œæ”¯æŒå¹¶å‘è®¿é—®å’Œç›‘æ§
- **äº‹ä»¶ç³»ç»Ÿ**: åŸºäºæ¡ä»¶ç›‘æ§çš„äº‹ä»¶è§¦å‘æœºåˆ¶

#### âœ… EATIæ˜ å°„å®Œæ•´æ€§
- **ç›´æ¥æ˜ å°„**: 8/10ä¸ªä¸»è¦EATIè¦ç´ æœ‰å¯¹åº”å®ç°
- **åŠŸèƒ½è¦†ç›–**: å¹³å‡85%çš„åŠŸèƒ½å®Œæ•´åº¦
- **å‚æ•°ä¼ é€’**: å®Œæ•´çš„ä½œç”¨åŸŸå’Œä¸Šä¸‹æ–‡æ˜ å°„è§„èŒƒ

#### âœ… éªŒè¯åŸºå‡†å»ºç«‹
- **é‡åŒ–æ ‡å‡†**: æ˜ç¡®çš„æœ€ç»ˆçŠ¶æ€æœŸæœ›å€¼
- **æ—¶åºè§„èŒƒ**: è¯¦ç»†çš„äº‹ä»¶è§¦å‘åºåˆ—å’Œæ—¶é—´çº¦æŸ
- **æ€§èƒ½æŒ‡æ ‡**: æ‰§è¡Œæ—¶é—´ã€å†…å­˜ä½¿ç”¨ã€é€šä¿¡å»¶è¿ŸåŸºå‡†
- **æ¦‚ç‡éªŒè¯**: éšæœºäº‹ä»¶çš„ç»Ÿè®¡éªŒè¯æ ‡å‡†

#### âœ… å¯å¤ç°æµ‹è¯•æ¡†æ¶
- **ç«¯åˆ°ç«¯éªŒè¯**: å®Œæ•´çš„ä»»åŠ¡æµç¨‹éªŒè¯è„šæœ¬
- **è¾¹ç•Œæ¡ä»¶**: å¼‚å¸¸åœºæ™¯å’Œèµ„æºçº¦æŸæµ‹è¯•
- **æ€§èƒ½åŸºå‡†**: å¤šç»´åº¦æ€§èƒ½è¯„ä¼°æ¡†æ¶
- **éšæœºæ€§æ§åˆ¶**: å›ºå®šç§å­ä¿è¯å¯é‡ç°æ€§

### å…³é”®å‘ç°

#### ğŸ¯ ä¼˜åŠ¿ç‰¹æ€§
1. **æ¶æ„æ¸…æ™°**: å®ä½“-åŠ¨ä½œ-æ´»åŠ¨ä¸‰å±‚æ¶æ„ï¼ŒèŒè´£åˆ†ç¦»æ˜ç¡®
2. **è£…é¥°å™¨ç³»ç»Ÿ**: æ´»åŠ¨è£…é¥°å™¨æä¾›ç»Ÿä¸€çš„ç›‘æ§å’Œæ—¥å¿—åŠŸèƒ½
3. **å®æ—¶ç›‘æ§**: WebSocketæ¨é€æœºåˆ¶æ”¯æŒä»¿çœŸè¿‡ç¨‹å¯è§†åŒ–
4. **çŠ¶æ€ä¸€è‡´æ€§**: å…¨å±€å˜é‡å’Œå®ä½“çŠ¶æ€åŒæ­¥æœºåˆ¶å®Œå–„

#### âš ï¸ æ”¹è¿›ç©ºé—´
1. **ä»»åŠ¡æŠ½è±¡**: ç¼ºå°‘æ˜¾å¼Taskæ¦‚å¿µï¼Œä¸»è¦é€šè¿‡å®ä½“åä½œä½“ç°
2. **èµ„æºç±»å‹**: ä»…å®ç°Containerï¼Œç¼ºå°‘ä¼˜å…ˆçº§å’ŒæŠ¢å èµ„æº
3. **äº¤äº’æ¨¡å¼**: ä¸»è¦æ˜¯å¼‚æ­¥æ¶ˆæ¯ï¼Œç¼ºå°‘åŒæ­¥å’Œå¹¿æ’­äº¤äº’
4. **é”™è¯¯æ¢å¤**: åŸºç¡€çš„å¼‚å¸¸å¤„ç†ï¼Œç¼ºå°‘å¤æ‚çš„æ¢å¤ç­–ç•¥

### åç»­å·¥ä½œæŒ‡å¯¼

#### ğŸ”§ ä»£ç ç”Ÿæˆå™¨å¼€å‘é‡ç‚¹
1. **å®ä½“ç”Ÿæˆ**: é‡ç‚¹å®ç°å±æ€§ç®¡ç†ã€çŠ¶æ€æ›´æ–°ã€æ¶ˆæ¯å¤„ç†æœºåˆ¶
2. **æ´»åŠ¨è£…é¥°**: å¿…é¡»å®ç°æ´»åŠ¨è£…é¥°å™¨çš„å®Œæ•´åŠŸèƒ½
3. **å‚æ•°ä¼ é€’**: ä¸¥æ ¼æŒ‰ç…§EATIå‚æ•°ä¼ é€’è§„èŒƒå®ç°ä½œç”¨åŸŸè§£æ
4. **ç›‘æ§é›†æˆ**: WebSocketæ¨é€å’ŒçŠ¶æ€ç›‘æ§æ˜¯æ ¸å¿ƒç‰¹æ€§

#### ğŸ“Š éªŒè¯ç­–ç•¥ä¼˜å…ˆçº§
1. **æ ¸å¿ƒæµç¨‹**: ä¼˜å…ˆéªŒè¯æ•Œæƒ…å‘ç°â†’å†³ç­–â†’ç«åŠ›â†’è¯„ä¼°ä¸»æµç¨‹
2. **èµ„æºçº¦æŸ**: é‡ç‚¹æµ‹è¯•å¼¹è¯æ¶ˆè€—å’Œçº¦æŸæ£€æŸ¥æœºåˆ¶
3. **æ¦‚ç‡è¡Œä¸º**: ä½¿ç”¨ç»Ÿè®¡æ–¹æ³•éªŒè¯éšæœºäº‹ä»¶çš„æ­£ç¡®æ€§
4. **æ€§èƒ½åŸºå‡†**: å»ºç«‹æ‰§è¡Œæ—¶é—´å’Œå†…å­˜ä½¿ç”¨çš„å›å½’æµ‹è¯•

#### ğŸš€ æ‰©å±•è§„åˆ’
1. **ä»»åŠ¡ç³»ç»Ÿ**: å®ç°æ˜¾å¼Taskå®šä¹‰å’Œå¤šåˆå§‹åŠ¨ä½œæ”¯æŒ
2. **èµ„æºæ‰©å±•**: å¢åŠ ä¼˜å…ˆçº§èµ„æºã€æŠ¢å èµ„æºç±»å‹
3. **äº¤äº’å¢å¼º**: æ”¯æŒåŒæ­¥äº¤äº’ã€å¹¿æ’­æ¨¡å¼ã€QoSæ§åˆ¶
4. **å¯è§†åŒ–**: åŸºäºWebSocketæ•°æ®å¼€å‘å®æ—¶ä»¿çœŸç›‘æ§ç•Œé¢

---

**æœ¬åˆ†ææŠ¥å‘Šä¸ºEATI Schema 2.2.1åˆ°SimPyä»£ç ç”Ÿæˆå™¨é¡¹ç›®æä¾›äº†å¯é çš„å‚è€ƒåŸºå‡†å’ŒéªŒè¯æ ‡å‡†ï¼Œç¡®ä¿ç”Ÿæˆçš„ä»£ç åŠŸèƒ½å®Œæ•´ã€è¡Œä¸ºæ­£ç¡®ã€æ€§èƒ½å¯æ§ã€‚**